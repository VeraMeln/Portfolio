# Предсказание стоимости жилья в Калифорнии

## Задача

В проекте нужно обучить модель линейной регрессии на данных о жилье в Калифорнии в 1990 году с помощью библиотек pyspark и модуля MLlib.

На основе данных нужно предсказать медианную стоимость дома в жилом массиве — median_house_value.  Для оценки качества модели используются метрики RMSE, MAE и R2.

## Используемые библиотеки

pyspark, pandas, numpy

## Данные

- широта;
- долгота;
- медианный возраст жителей жилого массива;
- общее количество комнат в домах жилого массива;
- общее количество спален в домах жилого массива;
- количество человек, которые проживают в жилом массиве;
- количество домовладений в жилом массиве;
- медианный доход жителей жилого массива;
- медианная стоимость дома в жилом массиве;
- близость к океану.

## Результаты

Для обучения модели линейной регрессии нам доступны **данные о жилье в Калифорнии в 1990 году**. В них содержатся записи о 24 640 наблюдениях.

**Пропуски** содержались только в столбце total_bedrooms с общим количеством спален в домах жилого массива. Заполнили их медианным значением по столбцу.

**Категориальный признак обработали** следующим образом: сначала привели его числовому виду с помощью StringIndexer, затем преобразовали с помощью техники One hot encoding. 

Для повышения качества модели **создали несколько** новых **столбцов с числовыми признаками** (rooms_per_household, population_in_household и bedroom_index). 

Числовые признаки масштабировали с помощью StandardScaler.

**Модель линейной регрессии обучили два раза**: на всех имеющихся характеристиках (lr_all) и только на числовых (lr_num).

Для оценки качества получившихся моделей сравнили результаты работы линейной регрессии на двух наборах данных по метрикам **RMSE, MAE и R2**.

Анализ метрик моделей показал, что **результаты модели, которая обучалась на всех данных выше результатов модели, обученной только на числовых данных**. Прогноз отклоняется от реальных значений в среднем на 69 278 $.

Величина R2 в 0,65 говорит, что модель недостаточно хорошо подогнана к обучающим данным.

Возможные **дальнейшие пути улучшения качества прогнозов**:

- выбор более мощной модели
- генерация большего числа новых признаков
- более тонкая настройка гиперпараметров модели.


