# Стоимость подержанного автомобиля 
соревнование на Kaggle

## Задача

Многие знают про маркетплейсы где продаются б/у вещи, на которых есть возможность недорого купить качественную и полезную вещь. Но всегда волнует вопрос - кто и как устанавливает цену, и какие его характеристики больше всего влияют на итоговую стоимость продажи?! Вопрос становиться особо актуальным, если речь идет про дорогие товары, например про автомобили!
Данный проект - результат работы в Мастерской Яндекс Практикума, в рамках которой сы работали с данными о продажах автомобилей на вторичном рынке. 

Цель проекта: разработать модель предсказания стоимости автомобиля на вторичном рынке.

Работа модели оценивается по метрике MAPE (Mean Absolute Percentage Error).

## Используемые библиотеки

pandas, numpy, seaborn, sklearn

## Данные

- Год выпуска автомобиля.
- Марка автомобиля.
- издание автомобиля определенной марки.
- Уровни отделки салона автомобиля — это просто разные версии модели.
- Тип кузова транспортного средства относится к форме и модели конкретной марки автомобиля.
- механизм, который передает мощность от двигателя к колесам.
- идентификационный номер транспортного средства.
- штат, в котором автомобиль выставлен на аукцион.
- Состояние автомобилей на момент аукциона.
- расстояние, пройденное автомобилем с момента выпуска.
- Цвет кузова автомобиля.
- Цвет салона автомобиля.
- Продавец автомобиля, автосалоны.
- Рекорд рынка Manhiem, рыночная оценочная цена автомобилей.
- цена, по которой автомобиль был продан на аукционе.
- Дата продажи автомобиля.


## Результаты

Были опробованы модели **GradientBoostingRegressor, RandomForestRegressor, SGDRegressor** и **ElasticNet**. Самая низкая MAPE оказалась у GradientBoostingRegressor и RandomForestRegressor.

Для повышения точности предсказаний **обучающий набор был разбит на три части** – в зависимости от **класса машины**, который рассчитала ранее на основе медианной цены модели. **Для каждого класса отдельно были настроены свои модели**, которые сгенерировали предсказания. После введения такого разделения, MAPE на Kaggle улучшился на 10 % (с 32 до 21,9).

Для предсказания цены автомобиля **построен ансамбль моделей**.

На первом этапе **градиентный бустинг** генерирует предсказания на обучающих данных. Затем то же самое делает **решающий лес**. Их показания дописываются к имеющимся характеристикам в новые столбцы. Потом три датасета, соответствующие отдельным классам цен на модели, собирается в единый, который и передается **финальной модели градиентного бустинга**.

Такая последовательность действий позволила добиться лучшего **результата на Kaggle в 20,508 %**.

В результате анализа характеристик выяснилось, что **самыми важными** в принятии решений для моделей **оказались** следующие **характеристики:** 

- пробег авто, 
- медианная цена модели, 
- медианная цена продавца
- медианная цена года производства. 

Финальная модель градиентного бустинга при формировании предсказаний опиралась в основной на предсказания моделей предыдущего шага и на среднюю цену модели.