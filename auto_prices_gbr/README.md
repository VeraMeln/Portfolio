# Определение стоимости автомобилей

## Задача

Сервис по продаже автомобилей с пробегом «Не бит, не крашен» разрабатывает приложение, чтобы привлечь новых клиентов. В нём можно будет узнать рыночную стоимость своего автомобиля. 

Постройте модель, которая умеет её определять. В вашем распоряжении данные о технических характеристиках, комплектации и ценах других автомобилей.

Критерии, которые важны заказчику:
- качество предсказания;
- время обучения модели;
- время предсказания модели.

## Используемые библиотеки

pandas, numpy, seaborn, matplotlib, datetime, sklearn, lightgbm, catboost, category_encoders

## Данные

Признаки
- DateCrawled — дата скачивания анкеты из базы
- VehicleType — тип автомобильного кузова
- RegistrationYear — год регистрации автомобиля
- Gearbox — тип коробки передач
- Power — мощность (л. с.)
- Model — модель автомобиля
- Kilometer — пробег (км)
- RegistrationMonth — месяц регистрации автомобиля
- FuelType — тип топлива
- Brand — марка автомобиля
- Repaired — была машина в ремонте или нет
- DateCreated — дата создания анкеты
- NumberOfPictures — количество фотографий автомобиля
- PostalCode — почтовый индекс владельца анкеты (пользователя)
- LastSeen — дата последней активности пользователя

Целевой признак
- Price — цена (евро)

## Результаты
Нам доступны данные, которые содержат **354 369 строк, 15 характеристик и целевой признак**.

**Проведен анализ данных**. В данных содержатся дубликаты, пропуски и аномальные значения. В результате предварительной обработки удалены аномальные значения (менее 7 % наблюдений). Для обработки пропусков **написан трансформер данных**, который можно будет **передать заказчику** вместе с моделью.

Проведен **отбор признаков**, выявлены неинформативные для модели, **добавлены новые** характеристики:
- возраст автомобиля
- средний пробег авто за год

На имеющихся данных **обучены три модели**: 
- LGBMRegressor, 
- CatBoostRegressor
- LinearRegression. 

Для линейной регрессии была проведена дополнительная обработка категориальных признаков и масштабирование. Для каждой модели подобраны гиперпараметры и приведены показатели качества предсказаний (RMSE), среднее время обучения по фолдам и время предсказания. 

В результате сравнения ключевых для заказчика показателей качества выбрана модель **выберем LGBMRegressor** со следующими **значениями параметров**:
- force_row_wise=True
- max_depth=10,
- n_estimators=1000,
- n_jobs=8,
- num_leaves=30
- random_state=12345 

Ее преимуществ (числовые данные на тестовой выборке)а:

- самое **высокое качество предсказаний** (RMSE =1552)
- самое  **низкое время обучения** (2.14 сек)
- **приемлемое время предсказания** (0.38 сек)
- более **простой процесс предобработки** данных

Проведен **анализ характеристик** лучшей модели. В **пятерку самых важных** вошли:

- мощность двигателя
- регион продажи (определяется по почтовому индексу)
- год регистрации автомобиля
- модель авто
- средний пробег в год
